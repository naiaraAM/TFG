#!/bin/bash

root_directory=../../samples
output_directory=../../results_analysis
output_file="first_bytes_extracted.tsv"  # Using .tsv extension for clarity

# If file exists, delete it
if [ -f "$output_directory/$output_file" ]; then
    rm "$output_directory/$output_file"
fi
echo -e "filename\tmalware_name\tsource\tfirst_bytes" > "$output_directory/$output_file"

find "$root_directory" -type f -print | while read -r file; do
    filename=$(basename "$file")
    malware_name=$(basename "$(dirname "$file")")
    source=$(basename "$(dirname "$(dirname "$file")")")
    first_bytes=$(python3 ../../scripts/python/clean_bytes.py "$file")
    echo -e "$filename\t$malware_name\t$source\t$first_bytes" >> "$output_directory/$output_file"
done